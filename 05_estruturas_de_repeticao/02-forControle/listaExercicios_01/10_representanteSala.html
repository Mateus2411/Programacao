<meta charset="UTF-8" />
<script>
  /*
      PROBLEMA: REPRESENTANTE DE SALA
      Peça para o programa perguntar ao professor regente o nome dos três candidatos a representante da sala.
      Peça também para o programa perguntar ao professor regente a quantidade de alunos votantes.
      Desenvolva um programa que armazene o voto de cada aluno da sala e apresente o resultado da votação, com o quantitativo de votos e também a porcentagem de votos de cada candidato a representante de sala.
      */

  //ENTRADA

  let quantidadeDeCandidatos;
  do {
    quantidadeDeCandidatos = Number(prompt(`Qual a quantidade de candidatos`));
  } while (isNaN(quantidadeDeCandidatos) || quantidadeDeCandidatos <= 0);

  //Nome dos candidatos
  let candidatos = [
    {
      nome: "null",
      votos: 0,
      numero: 0,
    },
  ];

  // Quantidade de candidatos
  let numeroCandidato = 0;
  for (let a = 0; a < quantidadeDeCandidatos; a++) {
    let nomeCandidato;
    do {
      nomeCandidato = prompt(
        `Qual o nome do ${numeroCandidato + 1}° candidato?`
      );
    } while (!nomeCandidato || nomeCandidato.trim() === "");
    numeroCandidato++;
    candidatos.push({
      nome: `${nomeCandidato}`,
      votos: 0,
      numero: numeroCandidato,
    });
  }

  //Quantos alunos votantes
  let quantidadeDeAlunosVotantes;
  do {
    quantidadeDeAlunosVotantes = Number(prompt(`Quantos alunos votantes?`));
  } while (
    isNaN(quantidadeDeAlunosVotantes) ||
    quantidadeDeAlunosVotantes <= 0
  );

  //Votos
  let listaCandidatos = ``;
  for (let i = 0; i < candidatos.length; i++) {
    if (candidatos[i].nome !== "null") {
      listaCandidatos += `${i} - ${candidatos[i].nome}\n`;
    }
  }

  for (
    let repeticoes = 0;
    repeticoes < quantidadeDeAlunosVotantes;
    repeticoes++
  ) {
    let votarCandidato = Number(
      prompt(`Em quem gostaria de votar?\n Candidatos\n${listaCandidatos}`)
    );
    if (
      candidatos[votarCandidato] &&
      candidatos[votarCandidato].nome !== "null"
    ) {
      candidatos[votarCandidato].votos++;
    } else {
      alert("Voto inválido");
      repeticoes--; // Repetir se inválido
    }
  }

  //SAÍDA
  candidatos.sort((a, b) => b.votos - a.votos);
  let resultado = "Resultado da votação:\n";
  for (let i = 0; i < candidatos.length; i++) {
    if (candidatos[i].nome !== "null") {
      let porcentagem = (
        (candidatos[i].votos / quantidadeDeAlunosVotantes) *
        100
      ).toFixed(2);
      resultado += `${candidatos[i].nome}: ${candidatos[i].votos} votos (${porcentagem}%)\n`;
    }
  }
  if (candidatos[0] && candidatos[0].nome !== "null") {
    let porcentagemVencedor = (
      (candidatos[0].votos / quantidadeDeAlunosVotantes) *
      100
    ).toFixed(2);
    resultado += `\nO vencedor é o candidato ${candidatos[0].nome} com ${porcentagemVencedor}% dos votos.`;
  }
  alert(resultado);
</script>
<style>
  html {
    text-align: center;
    display: flex;
    justify-content: center;
    align-items: center;
  }
</style>
